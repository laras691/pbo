<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Laporan Perpustakaan</title>
    <style>
        body { font-family: Arial, sans-serif; }
        h1 { color: #4a76a8; text-align: center; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background-color: #4a76a8; color: white; }
        .header { margin-bottom: 20px; }
        .info { margin-bottom: 30px; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Laporan Perpustakaan</h1>
        <div class="info">
            <p>Jenis Laporan: {{ jenis_laporan|title }}</p>
            <p>Periode: {{ tanggal_mulai }} sampai {{ tanggal_selesai }}</p>
            <p>Dibuat pada: {% now "d F Y H:i" %}</p>
        </div>
    </div>
    
    <table>
        <thead>
            <tr>
                {% if jenis_laporan == 'peminjaman' %}
                <th>ID</th>
                <th>Buku</th>
                <th>Peminjam</th>
                <th>Tanggal Pinjam</th>
                <th>Status</th>
                {% elif jenis_laporan == 'buku' %}
                <th>Judul</th>
                <th>Pengarang</th>
                <th>Kategori</th>
                <th>Stok</th>
                {% else %}
                <th>Nama</th>
                <th>Email</th>
                <th>Terakhir Login</th>
                <th>Status</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for item in data %}
            <tr>
                {% if jenis_laporan == 'peminjaman' %}
                <td>{{ item.id }}</td>
                <td>{{ item.buku.judul }}</td>
                <td>{{ item.pengunjung.nama_lengkap }}</td>
                <td>{{ item.tanggal_pinjam|date:"d M Y" }}</td>
                <td>{{ item.status }}</td>
                {% elif jenis_laporan == 'buku' %}
                <td>{{ item.judul }}</td>
                <td>{{ item.pengarang }}</td>
                <td>{{ item.kategori.nama }}</td>
                <td>{{ item.stok }}</td>
                {% else %}
                <td>{{ item.nama_lengkap }}</td>
                <td>{{ item.email }}</td>
                <td>{{ item.terakhir_login|date:"d M Y H:i" }}</td>
                <td>{% if item.is_active %}Aktif{% else %}Nonaktif{% endif %}</td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>